
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gaussian Processes 1: Preliminaries &#8212; Research Notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/gaussian_processes/preliminaries';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gaussian Processes 2: Gaussian process regression" href="gp_regression.html" />
    <link rel="prev" title="Gaussian Processes" href="overview.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Research Notes - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Research Notes - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Machine Learning Notes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="overview.html">Gaussian Processes</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Gaussian Processes 1: Preliminaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp_regression.html">Gaussian Processes 2: Gaussian process regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="pseudo_data.html">Gaussian Processes 3: Sparse GPs with inducing points</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ethanweinberger/Research_Notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ethanweinberger/Research_Notes/issues/new?title=Issue%20on%20page%20%2Fcontent/gaussian_processes/preliminaries.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/gaussian_processes/preliminaries.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Gaussian Processes 1: Preliminaries</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="gaussian-processes-1-preliminaries">
<h1>Gaussian Processes 1: Preliminaries<a class="headerlink" href="#gaussian-processes-1-preliminaries" title="Link to this heading">#</a></h1>
<p>We begin with a general definition.</p>
<div class="proof definition admonition" id="stochastic-process">
<p class="admonition-title"><span class="caption-number">Definition 1 </span></p>
<section class="definition-content" id="proof-content">
<p>A stochastic process <span class="math notranslate nohighlight">\(f\)</span> is a collection of random variables indexed by <span class="math notranslate nohighlight">\(x \in \mathcal{X}\)</span>. I.e.,</p>
<div class="math notranslate nohighlight">
\[ f = \{ f(x) : x \in \mathcal{X}\} \]</div>
</section>
</div><p>In the above definition, <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>  is an arbitrary indexing set. When modeling real-world
phenomena, we typically assume that <span class="math notranslate nohighlight">\(\mathcal{X}\)</span> corresponds to some semantically meaningful concept. For example,
if we want to model some phenomenon over <em>time</em>, we could use <span class="math notranslate nohighlight">\(\mathcal{X} = \mathbb{R}\)</span> with <span class="math notranslate nohighlight">\(x \in \mathcal{X}\)</span>
corresponding to an individual point in time. Similarly, if we want to model some phenomenon that varies across
two-dimensional <em>space</em> we could let <span class="math notranslate nohighlight">\(\mathcal{X} = \mathbb{R}^2\)</span> with <span class="math notranslate nohighlight">\(x \in \mathcal{X}\)</span> now corresponding
to spatial coordinates.</p>
<p>Perhaps the most famous example of a stochastic process is <a class="reference external" href="https://en.wikipedia.org/wiki/Brownian_motion">Brownian motion</a>,
originally conceived to model the behavior of particles suspended in a fluid. In short, this process models the
change in a particle’s position <span class="math notranslate nohighlight">\(p\)</span> over time <span class="math notranslate nohighlight">\(x\)</span>, where a partical is assumed to move as a result of collisions
with other particles. Omitting the specific mathematical details for now, in the below figure we plot five different paths
simulated according to a Brownian motion process.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">total_time</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">nb_steps</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="n">total_time</span> <span class="o">/</span> <span class="n">nb_steps</span>
<span class="n">nb_processes</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Simulate 5 different motions</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Mean of each movement</span>
<span class="n">stdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta_t</span><span class="p">)</span>  <span class="c1"># Standard deviation of each movement</span>

<span class="c1"># Simulate the brownian motions in a 1D space by cumulatively</span>
<span class="c1">#  making a new movement delta_d</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span>
    <span class="c1"># Move randomly from current location to N(0, delta_t)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">stdev</span><span class="p">,</span> <span class="p">(</span><span class="n">nb_processes</span><span class="p">,</span> <span class="n">nb_steps</span><span class="p">)),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1"># Make the plots</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_time</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_processes</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">((</span>
    <span class="s1">&#39;Brownian motion process</span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="s1">&#39;Position over time for 5 independent realizations&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ (time)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$p$ (position)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a591399e8ec4285e38a9b63e7f53fcd02526d59747f4a2b11aa29c77a06ddd12.png" class="align-center" src="../../_images/a591399e8ec4285e38a9b63e7f53fcd02526d59747f4a2b11aa29c77a06ddd12.png" />
</div>
</div>
<p>From the plot above, we can see that each sample path from the Brownian motion process can be seen as producing
a new function of position versus time. We can thus think of our stochastic process <span class="math notranslate nohighlight">\(f\)</span> as representing a <em>distribution
over functions</em> of <span class="math notranslate nohighlight">\(x\)</span>, which we could sample like any other probability distribution.</p>
<hr class="docutils" />
<p>When considering real-world phenomena over space, time, etc., we’ll typically only have observed samples corresponding
to a finite number of input <span class="math notranslate nohighlight">\(x\)</span> values. However, ideally we would be able to make predictions for new inputs <span class="math notranslate nohighlight">\(x'\)</span>. Moreover,
we might want to do so probabilisticly, so that we can provide measures of uncertainty (e.g. confidence intervals) for our
predictions. At a high-level, one potential way for doing so would be to assume that <span class="math notranslate nohighlight">\(f\)</span> is drawn from some prior distribution,
and then apply Bayes rule with our observed data to obtain corresponding posterior distributions over unseen function outputs.
Slightly more formally, letting <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> denote a set of observed outputs from our process with corresponding inputs <span class="math notranslate nohighlight">\(X\)</span>,
and <span class="math notranslate nohighlight">\(\mathbf{f}_*\)</span> denote a set of unseen outputs from inputs <span class="math notranslate nohighlight">\(X^*\)</span>, we would want to compute:</p>
<div class="math notranslate nohighlight">
\[
p(\mathbf{f}_* \mid \mathbf{f}) \propto p(\mathbf{f} \mid \mathbf{f}_*)p(\mathbf{f}_*)
\]</div>
<p>However, before proceeding in this direction, we must consider some technical issues. As hinted at previously, for
many real-world scenarios we’ll typically assume that the input domain <span class="math notranslate nohighlight">\(\mathcal{X} = \mathbb{R}^n\)</span> for some finite
<span class="math notranslate nohighlight">\(n\)</span>. For example, setting <span class="math notranslate nohighlight">\(n=1\)</span> corresponds to the case where our process varies over time while <span class="math notranslate nohighlight">\(n=2\)</span> would corresond
to a process varying over two-dimensional space. In such cases, <span class="math notranslate nohighlight">\(f\)</span> corresponds to an <em>infinite</em> collection of random
variables, and we say that <span class="math notranslate nohighlight">\(f\)</span> is an <em>infinite-dimensional process</em>.</p>
<p>While such processes are ubiquitous in the real world, dealing with infinite collections of random variables presents some mathematical difficulties. In particular, how would we even go about defining an infinite-dimensional process <span class="math notranslate nohighlight">\(f\)</span> without requiring us to write down an infinite number mathematical statements (and thus never actually finishing our definition)? Fortunately for us, Kolmogorov showed in his celebrated <a class="reference external" href="https://en.wikipedia.org/wiki/Kolmogorov_extension_theorem">extension theorem</a> that we can define a valid stochastic process by just specifying its corresponding set of <em>finite-dimensional distributions</em>.</p>
<div class="proof definition admonition" id="fdds">
<p class="admonition-title"><span class="caption-number">Definition 2 </span></p>
<section class="definition-content" id="proof-content">
<p>For a stochastic process <span class="math notranslate nohighlight">\(f\)</span> we define <span class="math notranslate nohighlight">\(f\)</span>’s finite-dimensional distributions (FDDs) as the collection of distributions</p>
<div class="math notranslate nohighlight">
\[
    \mathbb{P}(f(x_1) \leq y_1, \ldots, f(x_n) \leq y_n)
\]</div>
<p>for all finite sets <span class="math notranslate nohighlight">\((x_1, \ldots, x_n)\)</span> of indices in <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>,</p>
</section>
</div><p>Thus, we can specify a valid process by simply declaring the behavior of the joint distributions for collections of
<span class="math notranslate nohighlight">\(n\)</span> points.</p>
<hr class="docutils" />
<p>Now that we know how to specify a stochastic process, which one should we choose to define our prior over <span class="math notranslate nohighlight">\(f\)</span>? In general,
computing posterior distributions via Bayes rule is hard, and may not have closed-form solutions. However, one notable
exception is the case in which we assume the sets of variables <span class="math notranslate nohighlight">\(X_{1}\)</span> and <span class="math notranslate nohighlight">\(X_{2}\)</span> in Bayes rule follow a joint Gaussian
distribution. In particular, joint Gaussian distributions are closed under conditioning, with resulting parameters specified in the following proposition.</p>
<div class="proof proposition admonition" id="conditioning">
<p class="admonition-title"><span class="caption-number">Proposition 1 </span></p>
<section class="proposition-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(X_{1}\)</span> and <span class="math notranslate nohighlight">\(X_{2}\)</span> be two sets of random variables distributed as</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{bmatrix}
    X_1 \\ 
    X_2
\end{bmatrix}
\sim \mathcal{N}\left(\begin{bmatrix} \mathbf{\mu}_1 \\ \mathbf{\mu}_2 \end{bmatrix},\begin{bmatrix} \Sigma_{11}, \Sigma_{12}\\ \Sigma_{21}, \Sigma_{22} \end{bmatrix}\right)\end{split}\]</div>
<p>The conditional distribution of <span class="math notranslate nohighlight">\(X_2\)</span> given <span class="math notranslate nohighlight">\(X_1\)</span> is then</p>
<div class="math notranslate nohighlight">
\[ 
X_2 \mid X_1 \sim \mathcal{N}(\mathbf{\mu}_1 - \Sigma_{12}\Sigma_{22}^{-1}(X_2 - \mathbf{\mu}_2), \Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21})\]</div>
</section>
</div><p>This property is <em>extremely</em> useful, and motivates our central object of study: the <em>Gaussian process</em>.</p>
<div class="proof definition admonition" id="gaussian-process">
<p class="admonition-title"><span class="caption-number">Definition 3 </span></p>
<section class="definition-content" id="proof-content">
<p>A Gaussian process (GP) is a stochastic process with Gaussian finite dimensional distributions. I.e.,</p>
<div class="math notranslate nohighlight">
\[ (f(x_1), \ldots, f(x_n)) \sim \mathcal{N}(\mu, \Sigma)\]</div>
<p>A GP is completely specified by its mean and covariance, which specify as functions of the index set. For a GP <span class="math notranslate nohighlight">\(f\)</span> with
mean function <span class="math notranslate nohighlight">\(m(x)\)</span> and covariance function <span class="math notranslate nohighlight">\(k(x, x')\)</span>, we write</p>
<div class="math notranslate nohighlight">
\[f \sim \mathcal{GP}(m(x), k(x, x'))\]</div>
</section>
</div><p>To sample functions from the GP prior, we need to specify the mean function <span class="math notranslate nohighlight">\(m\)</span> and covariance function <span class="math notranslate nohighlight">\(k\)</span>. For computational convenience we’ll typically take <span class="math notranslate nohighlight">\(m(x) = 0\)</span>. For the covariance we can choose any positive semidefinite function, and we’ll typically choose <span class="math notranslate nohighlight">\(k\)</span> to reflect some prior knowledge on how our function outputs should vary with respect to the inputs. For example, if we expect output values to vary smoothly across time, we’ll choose <span class="math notranslate nohighlight">\(k\)</span> to reflect this fact; we defer a detailed discussion on kernel functions until later.</p>
<p>For now we’ll set <span class="math notranslate nohighlight">\(k\)</span> to the radial basis function (RBF) kernel, defined as</p>
<div class="math notranslate nohighlight">
\[k(\mathbf{x}, \mathbf{x}') = \exp\left(-\frac{||\mathbf{x} - \mathbf{x}'||^2}{2\sigma^2}\right).\]</div>
<p>Using this kernel, we can then draw functions from our GP prior, and we display some samples below:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span>

<span class="c1"># Define the exponentiated quadratic </span>
<span class="k">def</span> <span class="nf">exponentiated_quadratic</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exponentiated quadratic  with σ=1&quot;&quot;&quot;</span>
    <span class="c1"># L2 distance (Squared Euclidian)</span>
    <span class="n">sq_norm</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="s1">&#39;sqeuclidean&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sq_norm</span><span class="p">)</span>

<span class="c1"># Sample from the Gaussian process distribution</span>
<span class="n">nb_of_samples</span> <span class="o">=</span> <span class="mi">41</span>  <span class="c1"># Number of points in each function</span>
<span class="n">number_of_functions</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of functions to sample</span>
<span class="c1"># Independent variable samples</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">nb_of_samples</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Σ</span> <span class="o">=</span> <span class="n">exponentiated_quadratic</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>  <span class="c1"># Kernel of data points</span>

<span class="c1"># Draw samples from the prior at our data points.</span>
<span class="c1"># Assume a mean of 0 for simplicity</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_of_samples</span><span class="p">),</span>
    <span class="n">cov</span><span class="o">=</span><span class="n">Σ</span><span class="p">,</span> 
    <span class="n">size</span><span class="o">=</span><span class="n">number_of_functions</span>
<span class="p">)</span>

<span class="c1"># Plot the sampled functions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_functions</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$y = f(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Functions sampled from the GP prior&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ce59c98dc475d84e7b23b1e42b0b5ed75c0722d19c6c077133c323e75c2abf20.png" class="align-center" src="../../_images/ce59c98dc475d84e7b23b1e42b0b5ed75c0722d19c6c077133c323e75c2abf20.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/gaussian_processes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="overview.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gaussian Processes</p>
      </div>
    </a>
    <a class="right-next"
       href="gp_regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Gaussian Processes 2: Gaussian process regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ethan Weinberger
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>